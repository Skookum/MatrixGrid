# The Bonsai.js MatrixGrid

Have you ever had to work with compounding matrices? It&rsquo;s a bit
mind-boggling to try to figure out without being able to visualize it.

Henceforth you will no longer need to walk blind! Allow me to introduce
to you the Bonsai MatrixGrid!

## Simple Usage

See it in action in <a href="http://orbit.bonsaijs.org/#%2F%2F%20credits%3A%20http%3A%2F%2Ftwitter.com%2Fcrafics%0A%0Avar%20groups%20%3D%20%5B%5D%3B%0Agroups.push(%20new%20Group().addTo(stage)%20)%3B%0Agroups.push(%20new%20Group().addTo(stage)%20)%3B%0A%0Avar%20currentState%3B%0Avar%20blobs%20%3D%20%5B%5D%3B%0A%0Avar%20width%20%3D%20env.windowWidth%2F2%3B%20%2F%2F%20minus%20side%20nav%0A%0Avar%20setup%3B%0Afunction%20updateSetup()%20%7B%0A%20%20var%20width%20%3D%20env.windowWidth%2F2%3B%20%2F%2F%20minus%20side%20nav%0A%20%20setup%20%3D%20%7B%0A%20%20%20%20stageWidth%3A%20width%2C%0A%20%20%20%20stageHeight%3A%20env.windowHeight%2C%0A%20%20%20%20stageCenter%3A%20%7Bx%3Awidth%2F2%2Cy%3Aenv.windowHeight%2F2%7D%0A%20%20%7D%3B%0A%7D%0A%0AupdateSetup()%3B%0Aenv.on('change'%2C%20updateSetup)%3B%0A%0Avar%20dynamic%20%3D%20%7B%0A%20%20%20%20scale%3A%20true%2C%0A%20%20%20%20opacity%3A%20false%2C%0A%20%20%20%20blur%3A%20false%2C%0A%20%20%20%20speed%3A%201%0A%7D%3B%0A%2F*%20tools%20*%2F%0Avar%20fps%20%3D%20%7B%0A%20%20strength%3A20%2C%0A%20%20frameTime%3A0%2C%0A%20%20lastLoop%3Anew%20Date()%2C%0A%20%20thisLoop%3Anull%2C%0A%20%20measure%3Afunction()%7B%0A%20%20%20%20fps.frameTime%20%2B%3D%20((fps.thisLoop%3Dnew%20Date())-fps.lastLoop-fps.frameTime)%2Ffps.strength%3B%0A%20%20%20%20fps.lastLoop%20%3D%20fps.thisLoop%3B%0A%20%20%20%20return%20this%3B%0A%20%20%7D%2C%0A%20%20toString%3Afunction()%7B%0A%20%20%20%20return%20(1000%2Fthis.frameTime).toFixed(1)%20%2B%20%22%20fps%22%3B%0A%20%20%7D%0A%7D%3B%0Afunction%20newColor()%7B%0A%20%20return%20color('white').randomize()%3B%0A%7D%0Afunction%20newBlob()%7B%0A%20%20var%20blob%20%3D%20%7B%0A%20%20%20%20width%3AMath.random()*40%2C%0A%20%20%20%20height%3AMath.random()*40%2C%0A%20%20%20%20scale%3A0.2%2C%0A%20%20%20%20opacity%3A1%2C%0A%20%20%20%20x%3Asetup.stageCenter.x%2C%0A%20%20%20%20y%3Asetup.stageCenter.y%2C%0A%20%20%20%20xSpeed%3AMath.random()*10-5%2C%0A%20%20%20%20ySpeed%3AMath.random()*10-5%0A%20%20%7D%3B%0A%20%20blob.shape%20%3D%20Path.circle(blob.x%2Cblob.y%2Cblob.width).attr(%7BfillColor%3AnewColor()%2Copacity%3Ablob.opacity%7D)%3B%0A%20%20return%20blob%3B%0A%7D%0Afunction%20stats()%7B%0A%20%20var%20statsStr%20%3D%20blobs.length%2B%22%20blobs%20at%20%22%2Bfps.measure().toString()%3B%0A%20%20frameCalcText.attr('text'%2CstatsStr)%3B%0A%7D%0A%0A%2F*%20states%20*%2F%0Afunction%20stateInit()%7B%0A%20%20frameCalcText%20%3D%20new%20Text(%22Calculating...%22)%0A%20%20%20%20.attr(%7Bx%3A10%2Cy%3A16%2CfontFamily%3A%20'Arial'%2CfontSize%3A%20'12px'%2CtextFillColor%3A%20'black'%7D).addTo(stage)%3B%0A%20%20setInterval(stats%2C1000)%3B%0A%20%20currentState%20%3D%20stateRun%3B%0A%7D%0Afunction%20stateRun()%7B%0A%20%20stats()%3B%0A%20%20var%20i%3D0%3B%0A%20%20for(%3Bi%3Cdynamic.speed%3Bi%2B%2B)%7B%0A%20%20%20%20var%20blob%20%3D%20newBlob()%3B%0A%20%20%20%20blob.shape.addTo(groups%5B1%5D%2C0)%3B%0A%0A%20%20%20%20blobs.push(blob)%3B%0A%20%20%7D%0A%20%20%2F%2F%20filters%20are%20now%20on%20groups%0A%20%20if(dynamic.blur)%7B%20groups%5B1%5D.attr(%22filters%22%2C%20%5Bnew%20filter.Blur(2)%5D)%3B%20%7D%0A%20%20else%20%7B%20groups%5B1%5D.attr(%22filters%22%2C%20%5B%5D)%3B%20%7D%0A%20%20for(i%3D0%3Bi%3Cblobs.length%3Bi%2B%2B)%7B%0A%20%20%20%20if(blobs%5Bi%5D.opacity%3C%3D0%7C%7Cblobs%5Bi%5D.x%3Esetup.stageWidth%7C%7Cblobs%5Bi%5D.x%3C0%7C%7Cblobs%5Bi%5D.y%3Esetup.stageHeight%7C%7Cblobs%5Bi%5D.y%3C0)%7B%0A%20%20%20%20%20%20blobs%5Bi%5D.shape.remove()%3B%0A%20%20%20%20%20%20blobs.splice(i%2C1)%3B%0A%20%20%20%20%7D%0A%20%20%20%20blobs%5Bi%5D.x%20%2B%3D%20blobs%5Bi%5D.xSpeed%3B%0A%20%20%20%20blobs%5Bi%5D.y%20%2B%3D%20blobs%5Bi%5D.ySpeed%3B%0A%20%20%20%20blobs%5Bi%5D.scale%20*%3D%201.04%3B%0A%20%20%20%20blobs%5Bi%5D.opacity%20-%3D%200.015%3B%0A%20%20%20%20if(dynamic.scale)%7B%20blobs%5Bi%5D.shape.attr(%22scale%22%2C%20blobs%5Bi%5D.scale)%3B%20%7D%0A%20%20%20%20if(dynamic.opacity)%7B%20blobs%5Bi%5D.shape.attr(%22opacity%22%2C%20blobs%5Bi%5D.opacity)%3B%20%7D%0A%20%20%20%20%2F%2Fif(dynamic.blur)%7B%20blobs%5Bi%5D.shape.attr(%22filters%22%2C%20%5Bnew%20filter.Blur(1)%5D)%3B%20%7D%0A%20%20%20%20blobs%5Bi%5D.shape.attr(%22x%22%2C%20blobs%5Bi%5D.x)%3B%0A%20%20%20%20blobs%5Bi%5D.shape.attr(%22y%22%2C%20blobs%5Bi%5D.y)%3B%0A%20%20%7D%0A%7D%0Afunction%20statePause()%7B%20stats()%3B%20%7D%0Afunction%20stateDispose()%7B%20%2F*%20implement%20*%2F%20%7D%0A%0A%2F*%20init%20*%2F%0AcurrentState%20%3D%20stateInit%3B%0Astage.on(%22tick%22%2C%20function()%7B%20currentState()%3B%20%7D)%3B%0A%0A%0A(function(global)%7Bvar%20defaults%3D%7BgridOffset%3A10%2Ccolor%3A'%23ffc0cb'%2Cwidth%3A500%7D%3Bvar%20MatrixGrid%3Dfunction(options)%7Boptions%7C%7C(options%3D%7B%7D)%3Bthis.gridOffset%3Doptions.gridOffset%7C%7Cdefaults.gridOffset%3Bthis.color%3Doptions.color%7C%7Coptions.fill%7C%7Cdefaults.color%3Bthis.matrix%3Doptions.matrix%7C%7Cnew%20Matrix()%3Bthis.origin%3Doptions.origin%7C%7Cnew%20Point()%3Bthis.width%3Doptions.width%7C%7Cdefaults.width%3Bthis.elements%3Dnew%20Group()%3Bthis.update(this.matrix%2Cthis.origin)%3Bthis.draw()%3B%7D%3BMatrixGrid.prototype%3D%7Bupdate%3Afunction(matrix%2Corigin)%7Bif(origin)%7Bthis.origin%3Dorigin%3Bthis.elements.attr('origin'%2Cthis.origin)%3B%7D%0Athis.matrix%3Dmatrix%3Bthis.elements.attr('matrix'%2Cthis.matrix)%3Bthis.draw()%3B%7D%2Cdraw%3Afunction()%7Bvar%20i%3DMath.round(this.width%2Fthis.gridOffset%2F2)%2Cstart%3D-this.width%2F2%2ClineWidth%3D1%2Coffset%3Bthis.clear()%3Bwhile(--i%3E-2)%7Boffset%3Di*this.gridOffset%3Bnew%20Rect(this.origin.x%2Bstart%2Cthis.origin.y-offset%2Cthis.width%2ClineWidth).fill(this.color).addTo(this.elements)%3Bnew%20Rect(this.origin.x%2Bstart%2Cthis.origin.y%2Boffset%2Cthis.width%2ClineWidth).fill(this.color).addTo(this.elements)%3Bnew%20Rect(this.origin.x-offset%2Cthis.origin.y%2Bstart%2ClineWidth%2Cthis.width).fill(this.color).addTo(this.elements)%3Bnew%20Rect(this.origin.x%2Boffset%2Cthis.origin.y%2Bstart%2ClineWidth%2Cthis.width).fill(this.color).addTo(this.elements)%3B%7D%0Anew%20Rect(this.origin.x-2%2Cthis.origin.y-2%2C4%2C4).fill('black').addTo(this.elements)%3Bthis.elements.addTo(stage)%3B%7D%2Cclear%3Afunction()%7Bthis.elements.clear()%3B%7D%2Cdestroy%3Afunction()%7Bvar%20self%3Dthis%3Bthis.elements.destroy()%3BObject.getOwnPropertyNames(this).forEach(function(prop)%7Bdelete%20self%5Bprop%5D%3B%7D)%3B%7D%7D%3Bif(typeof%20module!%3D'undefined')module.exports%3DMatrixGrid%3Belse%20if(typeof%20define%3D%3D'function'%26%26define.amd)define(MatrixGrid)%3Belse%20global%5B'MatrixGrid'%5D%3DMatrixGrid%3B%7D)(this)%3Bvar%20movieGrid%3Dnew%20MatrixGrid(%7Bcolor%3A'rgba(151%2C197%2C%20252%2C%200.3)'%2Cwidth%3A2000%7D))">Orbit</a>

``` javascript
var myRect = new Rect(x, y, width, height).fill('random').addTo(stage);
var myRectsMatrix = new MatrixGrid({ matrix: myRect.attr('matrix') });
myRect.on('draw', function () {
  myRectsMatrix.update(myRect.attr('matrix'));
});
```

Voil√†! You now have the ability to visualize the matrix of your bonsai
elements with each and every update. Enjoy!


## API

View the [docs](/Skookum/MatrixGrid/blob/master/docs.md)

